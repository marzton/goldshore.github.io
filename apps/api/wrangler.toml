name = "goldshore-api"
main = "dist/index.js"
compatibility_date = "2024-11-20"
workers_dev = true
minify = true

[build]
command = "pnpm run build"

[[d1_databases]]
binding = "DB"
database_name = "goldshore-db"
database_id = "00000000-0000-0000-0000-000000000000"

[[kv_namespaces]]
binding = "AGENT_PROMPT_KV"
id = "00000000000000000000000000000000"
preview_id = "dev-agent-prompt-kv"

[[d1_databases]]
binding = "DB"
database_name = "goldshore-db"
database_id = "00000000-0000-0000-0000-000000000000"

[[kv_namespaces]]
binding = "AGENT_PROMPT_KV"
id = "00000000000000000000000000000000"
preview_id = "dev-agent-prompt-kv"

[[kv_namespaces]]
binding = "CONFIG_KV"
id = "00000000000000000000000000000001"
preview_id = "dev-config-kv"

[[r2_buckets]]
binding = "SNAP_R2"
bucket_name = "goldshore-snap-r2"
preview_bucket_name = "dev-goldshore-snap-r2"

[[queues.producers]]
binding = "JOBS_QUEUE"
queue = "goldshore-jobs"

[vars]
GOLDSHORE_ENV = "production"
GOLDSHORE_ORIGIN = "https://goldshore.org"
GOLDSHORE_CORS = "https://goldshore.org,https://www.goldshore.org,https://admin.goldshore.org,https://preview.goldshore.org,http://localhost:5173,http://127.0.0.1:5173"
JWT_AUDIENCE = "goldshore-api"
JWT_ISSUER = "https://auth.goldshore.org"

[env.development.vars]
GOLDSHORE_ENV = "development"
GOLDSHORE_ORIGIN = "http://localhost:8787"
GOLDSHORE_CORS = "http://localhost:8787,http://localhost:3000"
JWT_AUDIENCE = "goldshore-api-dev"
JWT_ISSUER = "https://auth-dev.goldshore.org"

[triggers]
crons = ["*/30 * * * *"]

[[routes]]
pattern = "api.goldshore.org/*"
zone_name = "goldshore.org"

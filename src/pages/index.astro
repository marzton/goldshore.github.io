---
import BaseLayout from '../layouts/BaseLayout.astro';
import ApiStatus from '../components/ApiStatus.astro';
import GSHeader from '../components/ui/GSHeader';
import GSCard from '../components/ui/GSCard';
import formSubmitScript from '../scripts/form-submit.ts?url';
import { resolveApiUrl } from '../utils/api';

const apiUrl = import.meta.env.PUBLIC_API_URL || 'https://api.goldshore.org/v1';
const docsUrl = resolveApiUrl('./docs');
const healthUrl = resolveApiUrl('./health');
const riskPnlUrl = resolveApiUrl('./risk/pnl');
const leadEndpoint = resolveApiUrl('./lead');
const currentYear = new Date().getFullYear();

const productFeatures = [
  {
    title: 'Trading API',
    description: 'Deterministic routing, FIX connectivity, and low-latency order execution.',
    href: healthUrl,
    cta: 'Ping endpoint'
  },
  {
    title: 'Options & Risk',
    description: 'Structured risk analytics with scenario P&L and automated monitoring.',
    href: riskPnlUrl,
    cta: 'Review risk API'
  },
  {
    title: 'Admin & CRM',
    description: 'Provision customers, workflows, and lifecycle messaging from a unified hub.',
    href: 'https://admin.goldshore.org',
    cta: 'Launch admin'
  }
];

const pricingPlans = [
  {
    name: 'Free',
    price: '$0',
    description: 'Sandbox data, dashboard preview, and alert samples.',
    features: ['Sandbox trading dashboard', 'Core API key with rate limits', 'Community support'],
    planId: 'free'
  },
  {
    name: 'Pro',
    price: '$299',
    description: 'Production trading infrastructure with governance and audit trails.',
    features: ['Production-grade FIX sessions', 'Risk limit automation', 'Priority support desk'],
    planId: 'pro'
  },
  {
    name: 'Enterprise',
    price: 'Let’s talk',
    description: 'Dedicated clusters, co-location, and bespoke regulatory workflows.',
    features: ['Dedicated account team', 'Custom workflow automation', 'On-prem & hybrid deployment'],
    planId: 'enterprise'
  }
];

const integrationBadges = ['Cloudflare', 'D1', 'Queues', 'Vectorize'];
---
<BaseLayout>
  <GSHeader client:load />
  <main class="bg-bg text-text">
    <section class="relative overflow-hidden border-b border-border bg-surface/70">
      <div class="pointer-events-none absolute inset-x-0 -top-48 z-0 h-96 bg-[radial-gradient(circle_at_top,var(--gs-gold)_0%,rgba(227,179,65,0)_70%)] opacity-40"></div>
      <div class="relative z-10 mx-auto grid max-w-7xl gap-12 px-6 py-24 md:grid-cols-[1.1fr_0.9fr] md:items-center">
        <div class="space-y-6">
          <p class="gs-eyebrow">Capital-markets grade infrastructure</p>
          <h1 class="font-display text-4xl tracking-[-0.02em] text-text md:text-6xl">GoldShore — trading infrastructure &amp; insights</h1>
          <p class="gs-section-lead max-w-xl">
            Launch the trading stack your desk deserves: streaming data, supervised automation, and risk guardrails wired into every workflow.
          </p>
          <div class="flex flex-wrap items-center gap-4">
            <a class="gs-btn-primary" href="/dash">Launch Dashboard</a>
            <a class="gs-btn-secondary" href={docsUrl} rel="noreferrer">View API Docs</a>
          </div>
          <div class="flex flex-wrap gap-4 text-sm text-muted">
            <a class="gs-inline-link" href="/dash">Open Trading</a>
            <a class="gs-inline-link" href="https://admin.goldshore.org">Admin</a>
            <a class="gs-inline-link" href={docsUrl}>API Docs</a>
          </div>
        </div>
        <div class="space-y-6">
          <GSCard client:idle title="Live platform status">
            <div class="space-y-4 text-sm text-muted">
              <p>Always-on observability across routing, execution, and compliance.</p>
              <ApiStatus />
            </div>
          </GSCard>
        </div>
      </div>
    </section>

    <section id="products" class="gs-section border-b border-border/60 bg-bg">
      <div class="mx-auto max-w-7xl px-6">
        <div class="mb-12 gs-section-header">
          <p class="gs-eyebrow">Products</p>
          <h2 class="font-display text-3xl tracking-[-0.015em] md:text-4xl">Execution, oversight, and CRM in one stack</h2>
          <p class="gs-section-lead">
            GoldShore wraps trading automation with the controls front-office, risk, and operations teams expect. Explore each service below.
          </p>
        </div>
        <div class="grid gap-6 md:grid-cols-3">
          {productFeatures.map((feature) => (
            <a
              class="gs-feature-card"
              href={feature.href}
              target={feature.href.startsWith('http') ? '_blank' : undefined}
              rel="noreferrer"
            >
              <h3 class="font-display text-xl text-text">{feature.title}</h3>
              <p class="mt-3 flex-1 text-sm text-muted">{feature.description}</p>
              <div class="mt-4 flex items-center gap-2 text-sm font-medium">
                <span class="gs-inline-link">{feature.cta}</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 12h14m0 0-6-6m6 6-6 6" />
                </svg>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>

    <section id="pricing" class="gs-section border-b border-border/60 bg-surface/70">
      <div class="mx-auto max-w-7xl px-6">
        <div class="mb-12 gs-section-header">
          <p class="gs-eyebrow">Pricing</p>
          <h2 class="font-display text-3xl tracking-[-0.015em] md:text-4xl">Plans tuned for every desk</h2>
          <p class="gs-section-lead">
            Start with the free sandbox and graduate to production-ready execution, governance, and connectivity when you are ready.
          </p>
        </div>
        <div class="grid gap-6 md:grid-cols-3">
          {pricingPlans.map((plan) => (
            <div class="gs-panel gs-plan-card h-full" data-plan={plan.planId}>
              <div class="space-y-2">
                <h3 class="font-display text-2xl text-text">{plan.name}</h3>
                <p class="text-sm text-muted">{plan.description}</p>
              </div>
              <p class="mt-6 text-3xl font-semibold text-text">{plan.price}</p>
              <ul class="mt-6">
                {plan.features.map((feature) => (
                  <li class="flex items-center gap-2">
                    <span class="inline-flex h-2 w-2 rounded-full bg-[var(--brand)]"></span>
                    {feature}
                  </li>
                ))}
              </ul>
              <a class="gs-btn-primary gs-btn-sm mt-auto self-start" href={`/signup?plan=${plan.planId}`}>
                Choose Plan
              </a>
            </div>
          ))}
        </div>
      </div>
    </section>

    <section id="integrations" class="gs-section border-b border-border/60 bg-bg">
      <div class="mx-auto max-w-7xl px-6">
        <div class="mb-8 gs-section-header">
          <p class="gs-eyebrow">Integrations</p>
          <h2 class="font-display text-3xl tracking-[-0.015em] md:text-4xl">Deploy on trusted market infrastructure</h2>
          <p class="gs-section-lead">
            Build on top of Cloudflare primitives with durable storage, queues, and inference ready to go. Each badge jumps straight into the documentation.
          </p>
        </div>
        <div class="flex flex-wrap items-center gap-4">
          {integrationBadges.map((badge) => (
            <a class="gs-integration-badge" href={docsUrl} rel="noreferrer">
              <span class="inline-flex h-2 w-2 rounded-full bg-[var(--brand)]"></span>
              {badge}
            </a>
          ))}
        </div>
      </div>
    </section>

    <section id="contact" class="gs-section bg-surface/70">
      <div class="mx-auto grid max-w-5xl gap-8 px-6 md:grid-cols-[1fr_1fr]">
        <div class="space-y-4">
          <p class="gs-eyebrow">Contact</p>
          <h2 class="font-display text-3xl tracking-[-0.015em] md:text-4xl">Request a lead briefing</h2>
          <p class="gs-section-lead">
            Share a few details and our team will reach out with credentials, timelines, and integration guidance for your desk.
          </p>
          <p class="gs-muted-callout">We respond within one business day for regulated entities.</p>
        </div>
        <form
          id="lead-form"
          class="gs-panel gs-form p-6"
          method="post"
          action={leadEndpoint}
          data-api-form
          data-endpoint={leadEndpoint}
          data-method="POST"
          data-status-target="#lead-form-status"
          data-success-message="Thanks! The team will reach out shortly."
          data-pending-message="Sending…"
          data-error-message="We could not send your request. Email hello@goldshore.org and we will help right away."
          data-reset-on-success
        >
          <div class="grid gap-4 md:grid-cols-2">
            <label class="flex flex-col gap-1 text-sm">
              <span>Name</span>
              <input name="name" required />
            </label>
            <label class="flex flex-col gap-1 text-sm">
              <span>Email</span>
              <input type="email" name="email" required />
            </label>
          </div>
          <label class="flex flex-col gap-1 text-sm">
            <span>Company</span>
            <input name="company" />
          </label>
          <label class="flex flex-col gap-1 text-sm">
            <span>Notes</span>
            <textarea class="h-24" name="message" placeholder="Trading mandates, regulatory needs, timelines"></textarea>
          </label>
          <button class="gs-btn-primary" type="submit">Request Access</button>
          <p id="lead-form-status" class="gs-muted-callout"></p>
        </form>
      </div>
    </section>
  </main>

  <footer class="border-t border-border/60 bg-surface py-12">
    <div class="mx-auto grid max-w-7xl gap-10 px-6 md:grid-cols-[2fr_1fr_1fr]">
      <div class="space-y-4 text-sm text-muted">
        <img src="/assets/goldshore/logo-wordmark-on-light.svg" alt="GoldShore" class="h-6" loading="lazy" />
        <p>Trading infrastructure, risk analytics, and CRM tooling built for modern desks.</p>
        <div class="flex flex-wrap gap-4">
          <a class="hover:text-text" href="mailto:hello@goldshore.org">hello@goldshore.org</a>
          <a class="hover:text-text" href={apiUrl} rel="noreferrer">API status</a>
        </div>
      </div>
      <div>
        <h3 class="text-sm font-semibold uppercase tracking-[0.2em] text-muted">Sitemap</h3>
        <ul class="mt-4 space-y-2 text-sm text-muted">
          <li><a class="hover:text-text" href="/">Home</a></li>
          <li><a class="hover:text-text" href="/#products">Products</a></li>
          <li><a class="hover:text-text" href="/#pricing">Pricing</a></li>
          <li><a class="hover:text-text" href="/blog">Blog</a></li>
          <li><a class="hover:text-text" href={docsUrl}>Docs</a></li>
          <li><a class="hover:text-text" href="https://admin.goldshore.org">Admin</a></li>
        </ul>
      </div>
      <div>
        <h3 class="text-sm font-semibold uppercase tracking-[0.2em] text-muted">Legal &amp; Social</h3>
        <ul class="mt-4 space-y-2 text-sm text-muted">
          <li><a class="hover:text-text" href="/legal/terms">Terms</a></li>
          <li><a class="hover:text-text" href="/legal/privacy">Privacy</a></li>
          <li><a class="hover:text-text" href="#">LinkedIn</a></li>
          <li><a class="hover:text-text" href="#">X (Twitter)</a></li>
        </ul>
      </div>
    </div>
    <p class="mt-8 text-center text-xs text-muted">&copy; {currentYear} GoldShore. All rights reserved.</p>
  </footer>

  <script type="module" src={formSubmitScript}></script>
</BaseLayout>
